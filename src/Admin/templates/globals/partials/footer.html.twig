<script>
$(function() {
    $("#theform").on("submit", function () {
        return top.restoreSession();
    });

    // Ensure the first tab element is opened by default
    $(".sidebar a:first").tab('show');

    $('.srch div.control-label').wrapInner("<mark></mark>");
    $('.tab-pane .row.srch :first-child').closest('.tab-pane').each(function () {
        $(`#sidebarList a[href="#${this.id}"]`).wrapInner("<mark></mark>");
    });

    $(".multi-lang").select2();

    // Use the counter ($i) to make the form user friendly for user-specific globals use
    if ("{{ isUser|e('js') }}") {
        for (let j = 0; j <= i; j++) {
            $("#form" + j).change(function () {
                $("#toggle_" + j).prop('checked', false);
            });
            $("#toggle_" + j).change(function () {
                if ($('#toggle_' + j).prop('checked')) {
                    var defaultGlobal = $("#globaldefault_" + j).val();
                    $("#form_" + j).val(defaultGlobal);
                }
            });
        }
    }

    $(".color-code-button").on("click", function (e) {
        e.preventDefault();
        let default_color = $(this).data('default-color');
        let field_name = $(this).data('field');
        console.log(default_color);
        console.log(field_name);
    });

    var userMode = "{{ isUser|e('js') }}";

    $('.scroll').click(function () {
        window.parent.scrollTo({
            top: 0,
            behavior: 'smooth',
        });
        window.scrollTo({
            top: 0,
            behavior: 'smooth',
        });
        return false;
    });
});

{% if includeReload is true %}
if (parent.left_nav.location) {
    parent.left_nav.location.reload();
    parent.Title.location.reload();
    if (self.name === 'RTop') {
        parent.RBot.location.reload();
    } else {
        parent.RTop.location.reload();
    }
}
self.location.href='edit_globals.php?{{ (isUser) ? "mode=user" : :""}}&unique=yes';
{% endif %}

{% if includeWebServiceFailure is true %}
alert("{{ 'Offsite Portal web Service Failed'|translate|e('js') }}\n{{ value }}");
{% endif %}

{% if noSearchResults is true %}
alert("{{ search_query|e("js") }} {{ "not found, please try another search"|translate }}")
</script>
{% endif %}
